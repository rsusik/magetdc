
# MAG on ETDC

This is MAG variant that searches patterns in ETDC encoded text. This source code was written for research purpose and has a minimal error checking. The code may be not very readable and comments may not be adequate. There is no warranty, your use of this code is at your own risk.

**Note:** Please refer to following link for source codes of MAG algorithm: https://github.com/rsusik/mag


## Requirements
* C++ compiler compatible 
* Unix based 64-bit OS (compilation works also in Cygwin)

## Compilation

To compile the code run below line commands:
```shell
git clone https://github.com/rsusik/mag_etdc mag_etdc
cd mag_etdc
make all
```

## Running
```shell
./filename [enc_patt] [m], [enc_set], [u], [k], [q], [sig], [denom], [set]
```

where:
* filename - one of compiled executable (e.g. etdc\_mag\_l2)
* enc\_patt - /path/to encoded patterns 
* enc\_set  - /path/to encoded set (e.g. /path/to/english.200MB)
* m         - pattern length
* u         - FAOSO param
* k         - FAOSO param
* q         - q-gram size
* sig       - alphabet size
* denom     - specifies the offset of index tag (n/demon)
* set       - file set (used only for other file names generation, e.g. dictionary)

example:
```shell
./path/to/etdc_mag /path/to/english.200MB.processed.100.32.patt.bin 32 /path/to/english.200MB.processed.etdc.bin 4 2 3 4 100 /path/to/english.200MB
```

The *enc\_patt* and *enc\_set* can be generated by running `etdc_tool` executabe:
```shell
etdc_tool [path/to/text/set] [pnumber]
```

where:
* path/to/text/set - is a path to set
* pnumber - is a number of patterns to be generated

The program generates following files:
* [text\_filename].processed - file previousely processed with etdc\_parse\_text.py script
* [text\_filename].processed.dict - dictionary
* [text\_filename].processed.etdc.bin - encoded set
* [text\_filename].processed.[p_number].[m].bin - encoded patterns
* [text\_filename].processed.[p_number].[m].txt - patterns in plain text



The file `[text_filename].processed` should be generated with for example script `etdc_parse_text.py`:
```shell
python etdc\_parse\_text.py english.200MB
```

## Testing

There is a python script that helps in testing the performance of given algorithms.
To execute a test run following command:
`etdc_test.py [Alg] [Set] [#Patterns] [m] [U] [k] [q] [sigma] [demon]`

where:
* Alg - executable file (e.g. etdc\_mag\_l2)
* Set - set (e.g. english.200MB)
* #Patterns - number of patterns (e.g. 100)
* m - pattern length
* U - FAOSO param
* k - FAOSO param
* q - q-gram size
* sigma - alphabet size
* denom - specifies the offset of index tag (n/demon)

Example 1:
```shell
etdc_test.py etdc_mag.exe english.200MB 100,1000 8,16,32,64 4 2 2,3,4,5,6,7,8,9,10 4 100,10000,1000000
```

Example 2:
```shell
etdc_test.py etdc_mag_l2.exe english.200MB 100,1000 8,16,32,64 4 2 2,3,4,5,6,7,8,9,10 4 100,10000,1000000
```

*The above script may execute algorithms with incorrect parameters, and thus generate some errors in the output which can be ignored.*


## Quick Steps

1. Compile source codes (see Compilation section)
2. Parse the input file
	2.1. Replace set_loc value in file `etdc_parse_text.py` so it points to location where the sets are stored (e.g. *english.200MB*)
	2.2. Execute `etdc_parse_text.py` (see Running section)
3. Encode the text file and generate patterns
	3.1. Execute `etdc_tool` (see Running section)
4. Execute tests
	4.1. Replace parameters in test script `etdc_test.py`
		4.1.1. set_loc - location of files generated by `etdc_tool`
		4.1.2. alg_loc - location of executables
	4.2. Execute the tests (see Testing section)

## Authors

* Robert Susik
* Szymon Grabowski
* Kimmo Fredriksson
